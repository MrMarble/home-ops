apiVersion: v1
kind: ConfigMap
metadata:
  name: nextcloud-config
data:
  redis-cluster.config.php: |-
    <?php
    $CONFIG = [
      'filelocking.enabled' => true,
      'memcache.distributed' => '\\OC\\Memcache\\Redis',
      'memcache.locking' => '\\OC\\Memcache\\Redis',
      'redis.cluster' => [
        'seeds' => [
          'redis-node-0.redis-headless.database.svc.cluster.local:26379',
          'redis-node-1.redis-headless.database.svc.cluster.local:26379',
          'redis-node-2.redis-headless.database.svc.cluster.local:26379',
        ],
        'timeout' => 0.0,
        'read_timeout' => 0.0,
        'failover_mode' => \RedisCluster::FAILOVER_ERROR,
      ],
    ];
